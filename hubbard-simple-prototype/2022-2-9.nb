(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49732,       1405]
NotebookOptionsPosition[     45811,       1314]
NotebookOutlinePosition[     46167,       1330]
CellTagsIndexPosition[     46124,       1327]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Hubbard\:6a21\:578b\:4e2d\:7684\:7535\:5b50\:7b97\:7b26\:7684normal ordering\
\:ff1b\:8fd9\:91cci\:548cj\:4ec5\:4ec5\:8868\:793a\:62bd\:8c61\:7684\:683c\
\:70b9\:7f16\:53f7\:ff0c\:6211\:4eec\:5c1a\:672a\:5f15\:5165\:4e8c\:7ef4\:6b63\
\:65b9\:6676\:683c\:7684\:4efb\:4f55\:4fe1\:606f\
\>", "Text",
 CellChangeTimes->{{3.8533768991717873`*^9, 
  3.8533769394140267`*^9}},ExpressionUUID->"f9c8e5fc-bec8-4ace-844d-\
34a708cf59ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"normalOrderingRules", " ", "=", " ", 
    RowBox[{"{", " ", 
     RowBox[{"(*", 
      RowBox[{
       SuperscriptBox["c", "\[Dagger]"], " ", "means", " ", "creation", " ", 
       "and", " ", "c", " ", "means", " ", "annihilation"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"hubbardOpString", "[", 
         RowBox[{"a___", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["c", "\[Dagger]"], ",", " ", "i_", ",", " ", 
            "\[Alpha]_"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["c", "\[Dagger]"], ",", " ", "j_", ",", " ", 
            "\[Beta]_"}], "}"}], ",", " ", "b___"}], "]"}], " ", "/;", " ", 
        RowBox[{"i", " ", ">", " ", "j"}]}], " ", "\[Rule]", "   ", 
       RowBox[{"-", " ", 
        RowBox[{"hubbardOpString", "[", 
         RowBox[{"a", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["c", "\[Dagger]"], ",", " ", "j", ",", " ", 
            "\[Beta]"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["c", "\[Dagger]"], ",", " ", "i", ",", " ", 
            "\[Alpha]"}], "}"}], ",", " ", "b"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"hubbardOpString", "[", 
         RowBox[{"a___", ",", " ", 
          RowBox[{"{", 
           RowBox[{"c", ",", " ", "i_", ",", " ", "\[Alpha]_"}], "}"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"c", ",", " ", "j_", ",", " ", "\[Beta]_"}], "}"}], ",", 
          " ", "b___"}], "]"}], " ", "/;", " ", 
        RowBox[{"i", " ", "<", " ", "j"}]}], " ", "\[Rule]", "   ", 
       RowBox[{"-", " ", 
        RowBox[{"hubbardOpString", "[", 
         RowBox[{"a", ",", " ", 
          RowBox[{"{", 
           RowBox[{"c", ",", " ", "j", ",", " ", "\[Beta]"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"c", ",", " ", "i", ",", " ", "\[Alpha]"}], "}"}], ",", 
          " ", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hubbardOpString", "[", 
        RowBox[{"a___", ",", " ", 
         RowBox[{"{", 
          RowBox[{"c", ",", " ", "i_", ",", " ", "\"\<up\>\""}], "}"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"c", ",", " ", "i_", ",", " ", "\"\<down\>\""}], "}"}], ",",
          " ", "b___"}], "]"}], " ", "\[Rule]", " ", 
       RowBox[{"-", " ", 
        RowBox[{"hubbardOpString", "[", 
         RowBox[{"a", ",", " ", 
          RowBox[{"{", 
           RowBox[{"c", ",", " ", "i", ",", " ", "\"\<down\>\""}], "}"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"c", ",", " ", "i", ",", " ", "\"\<up\>\""}], "}"}], ",", 
          " ", "b"}], "]"}]}]}], " ", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hubbardOpString", "[", 
        RowBox[{"a___", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["c", "\[Dagger]"], ",", " ", "i_", ",", " ", 
           "\"\<down\>\""}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["c", "\[Dagger]"], ",", " ", "i_", ",", " ", 
           "\"\<up\>\""}], "}"}], ",", " ", "b___"}], "]"}], " ", "\[Rule]", 
       " ", 
       RowBox[{"-", " ", 
        RowBox[{"hubbardOpString", "[", 
         RowBox[{"a", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["c", "\[Dagger]"], ",", " ", "i", ",", " ", 
            "\"\<up\>\""}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["c", "\[Dagger]"], ",", " ", "i", ",", " ", 
            "\"\<down\>\""}], "}"}], ",", " ", "b"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"hubbardOpString", "[", 
        RowBox[{"a___", ",", " ", 
         RowBox[{"{", 
          RowBox[{"c", ",", " ", "i_", ",", " ", "\[Alpha]_"}], "}"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["c", "\[Dagger]"], ",", " ", "j_", ",", " ", 
           "\[Beta]_"}], "}"}], ",", " ", "b___"}], "]"}], " ", "\[Rule]", 
       " ", 
       RowBox[{
        RowBox[{"-", " ", 
         RowBox[{"hubbardOpString", "[", 
          RowBox[{"a", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["c", "\[Dagger]"], ",", " ", "j", ",", " ", 
             "\[Beta]"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"c", ",", " ", "i", ",", " ", "\[Alpha]"}], "}"}], ",", 
           " ", "b"}], "]"}]}], " ", "+", " ", 
        RowBox[{
         RowBox[{"Boole", "[", 
          RowBox[{"i", " ", "\[Equal]", " ", "j"}], "]"}], " ", 
         RowBox[{"Boole", "[", 
          RowBox[{"\[Alpha]", " ", "\[Equal]", " ", "\[Beta]"}], "]"}], " ", 
         RowBox[{"hubbardOpString", "[", 
          RowBox[{"a", ",", " ", "b"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8533188110083485`*^9, 3.8533188211605296`*^9}, {
  3.8533189443995996`*^9, 3.853318949468854*^9}, {3.8533190676620755`*^9, 
  3.8533190678636713`*^9}, {3.8533191247113085`*^9, 3.8533192465608177`*^9}, {
  3.853319329977851*^9, 3.853319352421511*^9}, {3.853320780842069*^9, 
  3.8533208057020345`*^9}, {3.853321219497088*^9, 3.853321223531379*^9}, {
  3.8533216779613094`*^9, 3.8533217040278273`*^9}, {3.853321802628147*^9, 
  3.8533218198281593`*^9}, {3.8533219346370955`*^9, 3.853321961006877*^9}, {
  3.853322011550762*^9, 3.8533221432645903`*^9}, {3.853322307903078*^9, 
  3.8533223322699623`*^9}, {3.8533849823115654`*^9, 3.853385003391217*^9}, {
  3.8533850763820724`*^9, 3.853385091903941*^9}, {3.85338514982308*^9, 
  3.8533852058231306`*^9}, {3.8533853081856623`*^9, 
  3.8533854371841745`*^9}},ExpressionUUID->"26c0e36c-4447-4768-a984-\
32d348daa5c1"],

Cell["\:793a\:4f8b\:ff1a", "Text",
 CellChangeTimes->{{3.8533769467110777`*^9, 3.8533769619338703`*^9}, 
   3.8533854134414597`*^9},ExpressionUUID->"25bc44b0-14d3-4ceb-bc46-\
702c325fb13d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"hubbardOpString", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", ",", " ", "1", ",", " ", "\"\<up\>\""}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"c", ",", " ", "1", ",", " ", "\"\<up\>\""}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["c", "\[Dagger]"], ",", " ", "1", ",", " ", 
      "\"\<up\>\""}], "}"}]}], "]"}], " ", "//.", " ", 
  "normalOrderingRules"}]], "Input",
 CellChangeTimes->{{3.8533221578241386`*^9, 3.853322201201851*^9}, {
   3.8533223387600737`*^9, 3.8533223395512695`*^9}, {3.8533223871186056`*^9, 
   3.8533223924788165`*^9}, {3.8533225263814735`*^9, 3.853322527852542*^9}, {
   3.853322987062072*^9, 3.853322988479055*^9}, 
   3.85338533133076*^9},ExpressionUUID->"1fef23ce-6564-454d-9ad7-\
2d774d893def"],

Cell[BoxData[
 RowBox[{"hubbardOpString", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["c", "\[Dagger]"], ",", "1", ",", "\<\"up\"\>"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "1", ",", "\<\"up\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "1", ",", "\<\"up\"\>"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.8533854190424204`*^9, 
  3.8533854408439617`*^9}},ExpressionUUID->"6644d64b-18b2-43a1-bc38-\
e31b54e98f0e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"hubbardOpString", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["c", "\[Dagger]"], ",", "1", ",", "\"\<up\>\""}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "1", ",", "\"\<up\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "1", ",", "\"\<up\>\""}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8533853313606977`*^9, 
  3.8533853313706903`*^9}},ExpressionUUID->"a75c4873-bd4a-432a-addc-\
46a8794787ab"],

Cell[BoxData[
 RowBox[{"hubbardOpString", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["c", "\[Dagger]"], ",", "1", ",", "\<\"up\"\>"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "1", ",", "\<\"up\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "1", ",", "\<\"up\"\>"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.8533854483206344`*^9},ExpressionUUID->"48d8e5f4-59af-4d9c-bde9-\
ecdeaf4f5b07"],

Cell["\<\
\:87ba\:65cb\:5f0f\:5730\:904d\:5386\:4e00\:4e2a\:4e8c\:7ef4\:6b63\:65b9\:6676\
\:683c\:5e76\:4e14\:7ed9\:683c\:70b9\:7f16\:4e0a\:53f7\
\>", "Text",
 CellChangeTimes->{{3.8533769700922637`*^9, 
  3.853376985913254*^9}},ExpressionUUID->"189a542d-bad8-48e8-aa8c-\
de25ecc5be14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"siteList", "[", "K_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", " ", 
      RowBox[{"r", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0"}], "}"}]}], ",", " ", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"n", " ", "\[LessEqual]", " ", "K"}], ",", " ", 
       RowBox[{"n", "++"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"result", ",", " ", "r"}], "]"}], ";", " ", 
           RowBox[{"r", " ", "+=", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "1"}], "}"}]}]}], " ", ",", " ", 
          RowBox[{
           RowBox[{"2", "n"}], " ", "-", " ", "1"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"result", ",", " ", "r"}], "]"}], ";", " ", 
           RowBox[{"r", " ", "-=", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "0"}], "}"}]}]}], ",", 
          RowBox[{
           RowBox[{"2", " ", "n"}], " ", "-", " ", "1"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"result", ",", " ", "r"}], "]"}], ";", " ", 
           RowBox[{"r", " ", "-=", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "1"}], "}"}]}]}], " ", ",", " ", 
          RowBox[{"2", "n"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"result", ",", " ", "r"}], "]"}], ";", " ", 
           RowBox[{"r", " ", "+=", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "0"}], "}"}]}]}], ",", " ", 
          RowBox[{"2", " ", "n"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.853365287736799*^9, 3.8533653164005995`*^9}, {
   3.853365685835001*^9, 3.8533656886617217`*^9}, {3.8533662866727123`*^9, 
   3.8533662886765237`*^9}, 3.853366322381568*^9, {3.8533674018201513`*^9, 
   3.8533674743032656`*^9}, {3.853367557285267*^9, 3.8533676381565003`*^9}, {
   3.853367683316659*^9, 3.8533677681402645`*^9}, {3.85336782301536*^9, 
   3.8533678278152733`*^9}, {3.853368050932598*^9, 
   3.853368197484036*^9}},ExpressionUUID->"5a33c8ff-be32-4b9d-b5d8-\
7b367bb8260d"],

Cell["\:793a\:4f8b\:ff1a", "Text",
 CellChangeTimes->{{3.8533769933541718`*^9, 
  3.8533769971870546`*^9}},ExpressionUUID->"07e48e38-8adb-47a5-ba2c-\
43fe3967f0cc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"siteList", "[", "5", "]"}]], "Input",
 CellChangeTimes->{{3.8533677714902067`*^9, 
  3.8533677731302586`*^9}},ExpressionUUID->"995d1854-2fc8-44f9-b85d-\
484f9900b2bc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", "3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"-", "3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"-", "3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", "5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"-", "5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"-", "5"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.853367773504059*^9, 3.8533678307597284`*^9, 
  3.853368199992608*^9},ExpressionUUID->"ddc3b1c6-8166-4c55-b680-\
078d5fd0a709"]
}, Open  ]],

Cell["\:7535\:5b50\:7b97\:7b26\:7684\:4e58\:6cd5\:548c\:5bf9\:6613\:5b50\:ff1a\
", "Text",
 CellChangeTimes->{{3.853377010221058*^9, 
  3.8533770286312075`*^9}},ExpressionUUID->"7f86f719-57e5-4c34-8281-\
d0f9746c097e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mulRule", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"hubbardOpString", "[", "a___", "]"}], " ", ".", "  ", 
     RowBox[{"hubbardOpString", "[", "b___", "]"}]}], " ", "\[Rule]", " ", 
    RowBox[{"hubbardOpString", "[", 
     RowBox[{"a", ",", " ", "b"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.853368780281019*^9, 3.8533687872179923`*^9}, {
  3.853368819217079*^9, 3.8533688741745167`*^9}, {3.8533695985804253`*^9, 
  3.853369611995862*^9}, {3.8533696876705484`*^9, 
  3.853369710221277*^9}},ExpressionUUID->"3d21592a-a007-4529-8fab-\
eaa19d8f64c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"comm", "[", 
    RowBox[{"a", ",", " ", "b"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", " ", ".", " ", "b"}], " ", "-", " ", 
       RowBox[{"b", " ", ".", " ", "a"}]}], ")"}], " ", "//.", " ", 
     "mulRule"}], " ", "//.", " ", "normalOrderingRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8533688581707215`*^9, 3.853368896079341*^9}, 
   3.8533696173541174`*^9, {3.8533697233444395`*^9, 
   3.853369726579771*^9}},ExpressionUUID->"c31fb352-1412-4d95-965e-\
35070b3f8e7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox["c", "\[Dagger]"], "[", 
    RowBox[{"i_", ",", " ", "\[Sigma]_"}], "]"}], " ", ":=", " ", 
   RowBox[{"hubbardOpString", "[", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["c", "\[Dagger]"], ",", " ", "i", ",", " ", "\[Sigma]"}],
      "}"}], "]"}]}], ";", " ", 
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{"i_", ",", " ", "\[Sigma]_"}], "]"}], " ", ":=", " ", 
   RowBox[{"hubbardOpString", "[", 
    RowBox[{"{", 
     RowBox[{"c", ",", " ", "i", ",", " ", "\[Sigma]"}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.853369290925902*^9, 3.8533693530402355`*^9}, {
   3.8533694862235494`*^9, 3.853369496795444*^9}, 
   3.8533853314007087`*^9},ExpressionUUID->"42afdc4c-2e75-458e-a931-\
fe69e2764ff4"],

Cell["\<\
\:5e38\:7528\:7b97\:7b26\:ff1a\:4e00\:4e2a\:683c\:70b9\:4e0a\:7684\:7535\:5b50\
\:6570\:ff0c\:4ee5\:53ca\:4e8c\:91cd\:5360\:636e\:6570\
\>", "Text",
 CellChangeTimes->{{3.853377036959697*^9, 
  3.853377052441017*^9}},ExpressionUUID->"ea993751-f49e-4944-923d-\
40bf5e9a7e1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "[", 
    RowBox[{"i_", ",", " ", "\[Sigma]_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["c", "\[Dagger]"], "[", 
      RowBox[{"i", ",", " ", "\[Sigma]"}], "]"}], " ", ".", " ", 
     RowBox[{"c", "[", 
      RowBox[{"i", ",", " ", "\[Sigma]"}], "]"}]}], " ", "//.", " ", 
    "mulRule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dc", "[", "i_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"n", "[", 
       RowBox[{"i", ",", " ", "\"\<up\>\""}], "]"}], " ", ".", " ", 
      RowBox[{"n", "[", 
       RowBox[{"i", ",", " ", "\"\<down\>\""}], "]"}]}], " ", "//.", " ", 
     "mulRule"}], " ", "//.", " ", "normalOrderingRules"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hopping", "[", 
    RowBox[{"i_", ",", " ", "j_", ",", " ", "\[Sigma]_"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["c", "\[Dagger]"], "[", 
       RowBox[{"i", ",", " ", "\[Sigma]"}], "]"}], " ", ".", " ", 
      RowBox[{"c", "[", 
       RowBox[{"j", ",", " ", "\[Sigma]"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["c", "\[Dagger]"], "[", 
       RowBox[{"j", ",", " ", "\[Sigma]"}], "]"}], " ", ".", " ", 
      RowBox[{"c", "[", 
       RowBox[{"i", ",", " ", "\[Sigma]"}], "]"}]}]}], " ", "//.", " ", 
    "mulRule"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.853376415993104*^9, 3.8533764964417906`*^9}, {
  3.853380049561414*^9, 3.853380081314638*^9}, {3.8533809932804875`*^9, 
  3.853381015571847*^9}},ExpressionUUID->"62af6b67-31c8-4056-8309-\
a21250ebae9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox["c", "\[Dagger]"], "[", 
    RowBox[{"1", ",", " ", "\"\<up\>\""}], "]"}], " ", ".", " ", 
   RowBox[{"c", "[", 
    RowBox[{"1", ",", " ", "\"\<up\>\""}], "]"}]}], " ", "//.", " ", 
  "mulRule"}]], "Input",
 CellChangeTimes->{{3.8533693588471055`*^9, 3.853369418055081*^9}, {
  3.85336953510851*^9, 3.8533695686004868`*^9}, {3.853369647846259*^9, 
  3.853369674852784*^9}, {3.8533697367926464`*^9, 
  3.853369744473031*^9}},ExpressionUUID->"81de7f96-f1d3-4d78-9141-\
96fb201eca72"],

Cell[BoxData[
 RowBox[{"hubbardOpString", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["c", "\[Dagger]"], ",", "1", ",", "\"\<up\>\""}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "1", ",", "\"\<up\>\""}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8533853314206653`*^9, 
  3.8533853314206653`*^9}},ExpressionUUID->"452660cc-cdca-42d3-9243-\
9416407b755b"],

Cell["\<\
\:5e38\:7528\:7b97\:7b26\:ff1a\:5e73\:5747\:5230\:6bcf\:4e2a\:683c\:70b9\:4e0a\
\:7684\:54c8\:5bc6\:987f\:91cf\
\>", "Text",
 CellChangeTimes->{{3.853378483429669*^9, 
  3.8533784922906914`*^9}},ExpressionUUID->"facf7cee-50b0-4d11-948e-\
745c5c0d7377"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hubbardSingleSiteHam", "[", 
    RowBox[{"t_", ",", " ", "U_"}], "]"}], " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["t", "2"]}], " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"hopping", "[", 
           RowBox[{"1", ",", " ", "j", ",", " ", "\[Sigma]"}], "]"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", 
            RowBox[{"{", 
             RowBox[{"2", ",", " ", "4", ",", " ", "6", ",", " ", "8"}], 
             "}"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", ",", " ", 
            RowBox[{"{", 
             RowBox[{"\"\<up\>\"", ",", " ", "\"\<down\>\""}], "}"}]}], 
           "}"}]}], "]"}]}], " ", "+", " ", 
       RowBox[{"U", " ", 
        RowBox[{"dc", "[", "1", "]"}]}]}], ")"}], " ", "//.", " ", 
     "mulRule"}], " ", "//.", " ", "normalOrderingRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8533685305697327`*^9, 3.853368532527342*^9}, {
   3.8533685814896803`*^9, 3.853368589129987*^9}, {3.8533689756249857`*^9, 
   3.8533690194572105`*^9}, {3.853369096419617*^9, 3.853369102556418*^9}, 
   3.8533697744425163`*^9, {3.8533698202222843`*^9, 3.853369826952465*^9}, {
   3.85337624352304*^9, 3.8533762463326445`*^9}, {3.853376311441374*^9, 
   3.853376375331276*^9}, {3.8533765061778145`*^9, 3.853376569711115*^9}, {
   3.8533800712766953`*^9, 
   3.853380095247995*^9}},ExpressionUUID->"ce93f713-6d09-4144-9d8a-\
910a63db9b0a"],

Cell[BoxData[
 RowBox[{"hubbardSingleSiteHam", "[", 
  RowBox[{"1.0", ",", " ", "1.0"}], "]"}]], "Input",
 CellChangeTimes->{{3.8533765564418464`*^9, 
  3.8533765601538234`*^9}},ExpressionUUID->"208572a9-647e-468a-953c-\
5eac6b71c04d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "0.5`"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "1", ",", "\"\<down\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "2", ",", "\"\<down\>\""}], "}"}]}], "]"}], "+", 
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "1", ",", "\"\<down\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "4", ",", "\"\<down\>\""}], "}"}]}], "]"}], "+", 
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "1", ",", "\"\<down\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "6", ",", "\"\<down\>\""}], "}"}]}], "]"}], "+", 
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "1", ",", "\"\<down\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "8", ",", "\"\<down\>\""}], "}"}]}], "]"}], "+", 
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "1", ",", "\"\<up\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "2", ",", "\"\<up\>\""}], "}"}]}], "]"}], "+", 
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "1", ",", "\"\<up\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "4", ",", "\"\<up\>\""}], "}"}]}], "]"}], "+", 
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "1", ",", "\"\<up\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "6", ",", "\"\<up\>\""}], "}"}]}], "]"}], "+", 
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "1", ",", "\"\<up\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "8", ",", "\"\<up\>\""}], "}"}]}], "]"}], "+", 
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "2", ",", "\"\<down\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "1", ",", "\"\<down\>\""}], "}"}]}], "]"}], "+", 
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "2", ",", "\"\<up\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "1", ",", "\"\<up\>\""}], "}"}]}], "]"}], "+", 
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "4", ",", "\"\<down\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "1", ",", "\"\<down\>\""}], "}"}]}], "]"}], "+", 
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "4", ",", "\"\<up\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "1", ",", "\"\<up\>\""}], "}"}]}], "]"}], "+", 
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "6", ",", "\"\<down\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "1", ",", "\"\<down\>\""}], "}"}]}], "]"}], "+", 
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "6", ",", "\"\<up\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "1", ",", "\"\<up\>\""}], "}"}]}], "]"}], "+", 
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "8", ",", "\"\<down\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "1", ",", "\"\<down\>\""}], "}"}]}], "]"}], "+", 
     RowBox[{"hubbardOpString", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["c", "\[Dagger]"], ",", "8", ",", "\"\<up\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "1", ",", "\"\<up\>\""}], "}"}]}], "]"}]}], ")"}]}],
   "-", 
  RowBox[{"1.`", " ", 
   RowBox[{"hubbardOpString", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["c", "\[Dagger]"], ",", "1", ",", "\"\<up\>\""}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["c", "\[Dagger]"], ",", "1", ",", "\"\<down\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "1", ",", "\"\<up\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c", ",", "1", ",", "\"\<down\>\""}], "}"}]}], "]"}]}]}]], \
"Input",
 CellChangeTimes->{{3.8533853314506817`*^9, 
  3.853385331561737*^9}},ExpressionUUID->"5f6628b3-b937-4360-bb11-\
bf1b77964fd2"],

Cell["\:4e0b\:9762\:751f\:62102006.06002\:4e2d\:7684\:516c\:5f0f2\:63d0\:5230\
\:7684\:7b97\:7b26\:96c6\:5408\:3002\:6839\:636e\:516c\:5f0f8\:ff0c\:6211\
\:4eec\:6709", "Text",
 CellChangeTimes->{{3.8533772932043824`*^9, 3.8533773240751367`*^9}, {
  3.8533773863913393`*^9, 
  3.853377514531464*^9}},ExpressionUUID->"07444fe5-a200-4716-a48b-\
24665182bd20"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sizeMeasure", "[", 
    RowBox[{
     RowBox[{"hubbardOpString", "[", "a___", "]"}], ",", " ", "sitelist_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", " ", "=", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"hubbardOpString", "[", "a", "]"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"r", " ", "+", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{
          RowBox[{"sitelist", "\[LeftDoubleBracket]", 
           RowBox[{
           "des", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "\[RightDoubleBracket]"}], ",", " ", "1"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"des", ",", " ", 
          RowBox[{"{", "a", "}"}]}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.853377375043211*^9, 3.8533773839239244`*^9}, {
   3.853377519716131*^9, 3.8533775198262615`*^9}, {3.8533776217126613`*^9, 
   3.853377624351559*^9}, {3.853377900661208*^9, 3.8533780060839405`*^9}, {
   3.85337805902427*^9, 3.8533780669028206`*^9}, {3.853378097112439*^9, 
   3.8533781509929385`*^9}, 3.853378235146785*^9, {3.8533790515502834`*^9, 
   3.853379121630884*^9}, {3.8533791582294884`*^9, 3.853379170290202*^9}, {
   3.8533805815471363`*^9, 
   3.8533805961359205`*^9}},ExpressionUUID->"c4911e6c-2550-48ec-82bc-\
5f88a1b26716"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sizeMeasure", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", 
      RowBox[{"3", ",", " ", "\"\<up\>\""}], "]"}], " ", ".", " ", 
     RowBox[{"c", "[", 
      RowBox[{"4", ",", " ", "\"\<up\>\""}], "]"}], " ", ".", " ", 
     RowBox[{
      SuperscriptBox["c", "\[Dagger]"], "[", 
      RowBox[{"10", ",", " ", "\"\<down\>\""}], "]"}]}], " ", "//.", " ", 
    "mulRule"}], ",", " ", 
   RowBox[{"siteList", "[", "6", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.853378153691757*^9, 3.853378213711198*^9}, {
  3.8533783742225895`*^9, 
  3.853378393812913*^9}},ExpressionUUID->"85eedc2c-6646-4964-92a6-\
3f68c811ca85"],

Cell[BoxData["9"], "Output",
 CellChangeTimes->{{3.853378201462619*^9, 3.853378237611232*^9}, 
   3.8533783942793064`*^9, 3.853379173023532*^9, 
   3.8533806048683963`*^9},ExpressionUUID->"0c1da4d7-c8c8-4b6b-8a17-\
f1b49ea93bea"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hubbardHam", "[", 
    RowBox[{"t_", ",", " ", "U_", ",", " ", "sitelist_"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ht", ",", " ", "HU"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HU", " ", "=", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"dc", "[", "i", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "sitelist", "]"}], "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ht", " ", "=", " ", 
       RowBox[{"Sum", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pos", " ", "=", " ", 
             RowBox[{"Position", "[", 
              RowBox[{"sitelist", ",", " ", 
               RowBox[{"h", " ", "+", " ", 
                RowBox[{
                "sitelist", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}], "]"}]}], "}"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "pos", "]"}], " ", "\[Equal]", " ", 
              "0"}], ",", " ", "0", ",", " ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"hopping", "[", 
                RowBox[{"i", ",", " ", 
                 RowBox[{
                  RowBox[{
                  "pos", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", " ", "\[Sigma]"}], "]"}], 
               ",", " ", 
               RowBox[{"{", 
                RowBox[{"\[Sigma]", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"\"\<up\>\"", ",", " ", "\"\<down\>\""}], "}"}]}], 
                "}"}]}], "]"}]}], "]"}]}], "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"h", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", " ", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", " ", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "sitelist", "]"}], "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["t", "2"]}], " ", "Ht"}], " ", "+", " ", 
       RowBox[{"U", " ", "HU"}]}]}]}], "\[IndentingNewLine]", "]"}]}], " ", 
  ";"}]], "Input",
 CellChangeTimes->{{3.853378432162696*^9, 3.853378441453291*^9}, {
   3.85337929606889*^9, 3.8533793055318737`*^9}, {3.853379598852928*^9, 
   3.8533796078729825`*^9}, {3.853379774562291*^9, 3.853379839361539*^9}, {
   3.853379971451146*^9, 3.853379983592346*^9}, {3.8533801771740594`*^9, 
   3.8533801822894945`*^9}, {3.8533802174454746`*^9, 3.853380252553318*^9}, {
   3.853380308801116*^9, 3.8533803445329227`*^9}, {3.8533804231562805`*^9, 
   3.85338045181228*^9}, {3.8533804913214808`*^9, 3.8533805015391245`*^9}, {
   3.8533806415594316`*^9, 3.8533806816658216`*^9}, {3.853380803816311*^9, 
   3.853380926661612*^9}, 3.853381518290246*^9, {3.8533816850958977`*^9, 
   3.8533816880943594`*^9}},ExpressionUUID->"1b0c0fb9-17ad-4460-b8ac-\
6ad8af926a12"],

Cell["\:4e3a\:4e86\:540e\:9762\:65b9\:4fbf\:ff08\:4e0d\:7528\:628a\:4e00\:6a21\
\:4e00\:6837\:7684\:7b97\:6cd5\:5bf9\:4ea7\:751f\:7b97\:7b26\:548c\:6e6e\:706d\
\:7b97\:7b26\:5404\:81ea\:5199\:4e00\:904d\:ff09\:ff0c\:6211\:4eec\:5b9a\:4e49\
\:5171\:8f6d\:8f6c\:7f6e\:3002", "Text",
 CellChangeTimes->{{3.853390418722965*^9, 
  3.8533904498324766`*^9}},ExpressionUUID->"d3f06ccf-29a9-4682-b091-\
756251f2e770"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dagger", "[", 
    RowBox[{"hubbardOpString", "[", "a___", "]"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"op", ",", " ", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"result", ",", " ", 
          RowBox[{"o", " ", "/.", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", " ", "\[Rule]", " ", 
              SuperscriptBox["c", "\[Dagger]"]}], ",", " ", 
             RowBox[{
              SuperscriptBox["c", "\[Dagger]"], " ", "\[Rule]", " ", "c"}]}], 
            "}"}]}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"o", ",", " ", 
          RowBox[{"Reverse", "[", 
           RowBox[{"{", "a", "}"}], "]"}]}], "}"}]}], "]"}], ";", " ", 
      RowBox[{"hubbardOpString", "@@", "result"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8533904510606775`*^9, 3.8533905144246225`*^9}, {
  3.8533906058124647`*^9, 3.8533906250270615`*^9}, {3.8533907128511715`*^9, 
  3.8533907304316206`*^9}, {3.853390790035859*^9, 3.853390792769642*^9}, {
  3.853397023923316*^9, 3.8533970901659656`*^9}, {3.853397138692298*^9, 
  3.8533971718947015`*^9}, {3.8533981279341216`*^9, 
  3.853398137903081*^9}},ExpressionUUID->"a67f5871-e87f-415b-b36c-\
1315e345ee56"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dagger", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"1", ",", " ", "\"\<up\>\""}], "]"}], " ", ".", " ", 
    RowBox[{"c", "[", 
     RowBox[{"2", ",", " ", "\"\<down\>\""}], "]"}], " ", ".", " ", 
    RowBox[{
     SuperscriptBox["c", "\[Dagger]"], "[", 
     RowBox[{"2", ",", " ", "\"\<down\>\""}], "]"}]}], " ", "//.", " ", 
   "mulRule"}], "]"}]], "Input",
 CellChangeTimes->{{3.853397173671151*^9, 3.853397208711243*^9}, {
  3.8533986227720585`*^9, 
  3.853398638092507*^9}},ExpressionUUID->"40f03de4-f3bd-49bd-8173-\
b0acc3a89a73"],

Cell[BoxData[
 RowBox[{"hubbardOpString", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c", ",", "2", ",", "\<\"down\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["c", "\[Dagger]"], ",", "2", ",", "\<\"down\"\>"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["c", "\[Dagger]"], ",", "1", ",", "\<\"up\"\>"}], "}"}]}],
   "]"}]], "Output",
 CellChangeTimes->{3.8533986384465218`*^9, 
  3.8533986811923556`*^9},ExpressionUUID->"b8b2be3f-4736-4fae-b587-\
018244a462b0"]
}, Open  ]],

Cell["\<\
\:73b0\:5728\:7684\:95ee\:9898\:662f\:600e\:6837\:4fdd\:8bc1\:6240\:6709\:6ee1\
\:8db3\:516c\:5f0f8\:7684\:7b97\:7b26\:5168\:90fd\:80fd\:591f\:6784\:9020\
\:51fa\:6765\:3002\:4f3c\:4e4e\:53ea\:8981\:5c06\:683c\:70b9\:5e8f\:5217\:6784\
\:9020\:5230(K+1)^2\:5c31\:884c\:3002\:6ce8\:610f\:540c\:4e00\:4e2a\:7b97\
\:7b26\:5e73\:65b9\:80af\:5b9a\:662f\:96f6\:3002\
\>", "Text",
 CellChangeTimes->{{3.8533858579848347`*^9, 3.853385881160934*^9}, {
  3.8533902006782327`*^9, 
  3.8533902041003113`*^9}},ExpressionUUID->"ffb2b6c4-1171-47cf-9f1e-\
5e72e2ce6cbf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"operatorSet", "[", "K_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l", ",", " ", "create", ",", " ", "anni", ",", " ", "ops"}], 
     "}"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{"l", ",", " ", "1", ",", " ", "K", ",", "  ", 
      RowBox[{"(*", "\:7b97\:7b26\:603b\:6570", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{"create", ",", " ", "1", ",", " ", "l", ",", "  ", 
         RowBox[{"(*", "\:4ea7\:751f\:7b97\:7b26\:6570\:76ee", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"anni", " ", "=", " ", 
           RowBox[{"l", " ", "-", " ", "create"}]}], ";"}]}], " ", 
        RowBox[{"(*", "\:6e6e\:706d\:7b97\:7b26\:6570\:76ee", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", " ", 
       "\[IndentingNewLine]", "ops"}]}], "\[IndentingNewLine]", "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.853384214591218*^9, 3.8533842232089677`*^9}, {
  3.853384742351297*^9, 3.8533847736512313`*^9}, {3.853384900833324*^9, 
  3.853384948163953*^9}, {3.853385889099019*^9, 
  3.853386025731533*^9}},ExpressionUUID->"a76f78c3-94c2-4b33-8a35-\
de3bf1b8c795"]
},
WindowSize->{896, 944},
WindowMargins->{{Automatic, -10}, {Automatic, 0}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (2017\:5e745\:670816\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 436, 8, 75, "Text", "ExpressionUUID" -> \
"f9c8e5fc-bec8-4ace-844d-34a708cf59ee"],
Cell[997, 30, 5959, 139, 555, "Input", "ExpressionUUID" -> \
"26c0e36c-4447-4768-a984-32d348daa5c1"],
Cell[6959, 171, 189, 3, 46, "Text", "ExpressionUUID" -> \
"25bc44b0-14d3-4ceb-bc46-702c325fb13d"],
Cell[CellGroupData[{
Cell[7173, 178, 807, 18, 81, "Input", "ExpressionUUID" -> \
"1fef23ce-6564-454d-9ad7-2d774d893def"],
Cell[7983, 198, 475, 13, 51, "Output", "ExpressionUUID" -> \
"6644d64b-18b2-43a1-bc38-e31b54e98f0e"]
}, Open  ]],
Cell[8473, 214, 474, 13, 51, "Input", "ExpressionUUID" -> \
"a75c4873-bd4a-432a-addc-46a8794787ab"],
Cell[8950, 229, 449, 13, 51, "Output", "ExpressionUUID" -> \
"48d8e5f4-59af-4d9c-bde9-ecdeaf4f5b07"],
Cell[9402, 244, 286, 6, 46, "Text", "ExpressionUUID" -> \
"189a542d-bad8-48e8-aa8c-de25ecc5be14"],
Cell[9691, 252, 2809, 68, 400, "Input", "ExpressionUUID" -> \
"5a33c8ff-be32-4b9d-b5d8-7b367bb8260d"],
Cell[12503, 322, 164, 3, 46, "Text", "ExpressionUUID" -> \
"07e48e38-8adb-47a5-ba2c-43fe3967f0cc"],
Cell[CellGroupData[{
Cell[12692, 329, 191, 4, 46, "Input", "ExpressionUUID" -> \
"995d1854-2fc8-44f9-b85d-484f9900b2bc"],
Cell[12886, 335, 8896, 330, 482, "Output", "ExpressionUUID" -> \
"ddc3b1c6-8166-4c55-b680-078d5fd0a709"]
}, Open  ]],
Cell[21797, 668, 218, 4, 46, "Text", "ExpressionUUID" -> \
"7f86f719-57e5-4c34-8281-d0f9746c097e"],
Cell[22018, 674, 608, 13, 76, "Input", "ExpressionUUID" -> \
"3d21592a-a007-4529-8fab-eaa19d8f64c3"],
Cell[22629, 689, 587, 15, 46, "Input", "ExpressionUUID" -> \
"c31fb352-1412-4d95-965e-35070b3f8e7b"],
Cell[23219, 706, 789, 21, 81, "Input", "ExpressionUUID" -> \
"42afdc4c-2e75-458e-a931-fe69e2764ff4"],
Cell[24011, 729, 284, 6, 46, "Text", "ExpressionUUID" -> \
"ea993751-f49e-4944-923d-40bf5e9a7e1b"],
Cell[24298, 737, 1722, 48, 163, "Input", "ExpressionUUID" -> \
"62af6b67-31c8-4056-8309-a21250ebae9a"],
Cell[26023, 787, 548, 13, 46, "Input", "ExpressionUUID" -> \
"81de7f96-f1d3-4d78-9141-96fb201eca72"],
Cell[26574, 802, 396, 11, 51, "Input", "ExpressionUUID" -> \
"452660cc-cdca-42d3-9243-9416407b755b"],
Cell[26973, 815, 262, 6, 46, "Text", "ExpressionUUID" -> \
"facf7cee-50b0-4d11-948e-745c5c0d7377"],
Cell[27238, 823, 1585, 38, 241, "Input", "ExpressionUUID" -> \
"ce93f713-6d09-4144-9d8a-910a63db9b0a"],
Cell[28826, 863, 235, 5, 46, "Input", "ExpressionUUID" -> \
"208572a9-647e-468a-953c-5eac6b71c04d"],
Cell[29064, 870, 5292, 153, 629, "Input", "ExpressionUUID" -> \
"5f6628b3-b937-4360-bb11-bf1b77964fd2"],
Cell[34359, 1025, 357, 6, 46, "Text", "ExpressionUUID" -> \
"07444fe5-a200-4716-a48b-24665182bd20"],
Cell[34719, 1033, 1464, 35, 152, "Input", "ExpressionUUID" -> \
"c4911e6c-2550-48ec-82bc-5f88a1b26716"],
Cell[CellGroupData[{
Cell[36208, 1072, 662, 17, 85, "Input", "ExpressionUUID" -> \
"85eedc2c-6646-4964-92a6-3f68c811ca85"],
Cell[36873, 1091, 229, 4, 46, "Output", "ExpressionUUID" -> \
"0c1da4d7-c8c8-4b6b-8a17-f1b49ea93bea"]
}, Open  ]],
Cell[37117, 1098, 3802, 90, 551, "Input", "ExpressionUUID" -> \
"1b0c0fb9-17ad-4460-b8ac-6ad8af926a12"],
Cell[40922, 1190, 408, 6, 75, "Text", "ExpressionUUID" -> \
"d3f06ccf-29a9-4682-b091-756251f2e770"],
Cell[41333, 1198, 1483, 36, 191, "Input", "ExpressionUUID" -> \
"a67f5871-e87f-415b-b36c-1315e345ee56"],
Cell[CellGroupData[{
Cell[42841, 1238, 584, 15, 51, "Input", "ExpressionUUID" -> \
"40f03de4-f3bd-49bd-8173-b0acc3a89a73"],
Cell[43428, 1255, 515, 15, 51, "Output", "ExpressionUUID" -> \
"b8b2be3f-4736-4fae-b587-018244a462b0"]
}, Open  ]],
Cell[43958, 1273, 563, 10, 75, "Text", "ExpressionUUID" -> \
"ffb2b6c4-1171-47cf-9f1e-5e72e2ce6cbf"],
Cell[44524, 1285, 1283, 27, 351, "Input", "ExpressionUUID" -> \
"a76f78c3-94c2-4b33-8a35-de3bf1b8c795"]
}
]
*)

